<!doctype html><html lang=en itemscope itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>Active monitoring of openQA jobs - openQA bites</title><meta name=description content="openqa-mon is a little command-line utility to monitor one or multiple openQA jobs for their status. This tool is useful if you want to live monitor a handful of jobs closely e."><meta name=author content="phoenix"><script type=application/ld+json>{"@context":"http://schema.org","@type":"WebSite","name":"openQA bites","url":"https:\/\/openQA-Bites.github.io\/"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Organization","name":"","url":"https:\/\/openQA-Bites.github.io\/"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https:\/\/openQA-Bites.github.io\/","name":"home"}},{"@type":"ListItem","position":3,"item":{"@id":"https:\/\/openQA-Bites.github.io\/posts\/2021-02-25-openqa-mon\/","name":"Active monitoring of open qa jobs"}}]}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","author":{"name":"phoenix"},"headline":"Active monitoring of openQA jobs","description":"openqa-mon is a little command-line utility to monitor one or multiple openQA jobs for their status. This tool is useful if you want to live monitor a handful of jobs closely e.","inLanguage":"en","wordCount":970,"datePublished":"2021-02-25T14:54:57","dateModified":"2021-02-25T14:54:57","image":"https:\/\/openQA-Bites.github.io\/img\/avatar-icon.png","keywords":["tools, openqa-mon, cli"],"mainEntityOfPage":"https:\/\/openQA-Bites.github.io\/posts\/2021-02-25-openqa-mon\/","publisher":{"@type":"Organization","name":"https:\/\/openQA-Bites.github.io\/","logo":{"@type":"ImageObject","url":"https:\/\/openQA-Bites.github.io\/img\/avatar-icon.png","height":60,"width":60}}}</script><meta property="og:title" content="Active monitoring of openQA jobs"><meta property="og:description" content="openqa-mon is a little command-line utility to monitor one or multiple openQA jobs for their status. This tool is useful if you want to live monitor a handful of jobs closely e."><meta property="og:image" content="https://openQA-Bites.github.io/img/avatar-icon.png"><meta property="og:url" content="https://openQA-Bites.github.io/posts/2021-02-25-openqa-mon/"><meta property="og:type" content="website"><meta property="og:site_name" content="openQA bites"><meta name=twitter:title content="Active monitoring of openQA jobs"><meta name=twitter:description content="openqa-mon is a little command-line utility to monitor one or multiple openQA jobs for their status. This tool is useful if you want to live monitor a handful of jobs closely e."><meta name=twitter:image content="https://openQA-Bites.github.io/img/avatar-icon.png"><meta name=twitter:card content="summary"><meta name=twitter:site content="@grisu48"><meta name=twitter:creator content="@grisu48"><link href=https://openQA-Bites.github.io/img/favicon.ico rel=icon type=image/x-icon><meta name=generator content="Hugo 0.101.0"><link rel=alternate href=https://openQA-Bites.github.io/index.xml type=application/rss+xml title="openQA bites"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css integrity=sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y crossorigin=anonymous><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.5.0/css/all.css integrity=sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU crossorigin=anonymous><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css integrity=sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u crossorigin=anonymous><link rel=stylesheet href=https://openQA-Bites.github.io/css/main.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic"><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800"><link rel=stylesheet href=https://openQA-Bites.github.io/css/syntax.css><link rel=stylesheet href=https://openQA-Bites.github.io/css/codeblock.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css integrity=sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css integrity=sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R crossorigin=anonymous></head><body><nav class="navbar navbar-default navbar-fixed-top navbar-custom"><div class=container-fluid><div class=navbar-header><button type=button class=navbar-toggle data-toggle=collapse data-target=#main-navbar>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span></button>
<a class=navbar-brand href=https://openQA-Bites.github.io/>openQA bites</a></div><div class="collapse navbar-collapse" id=main-navbar><ul class="nav navbar-nav navbar-right"><li class=navlinks-container><a class=navlinks-parent>openQA</a><div class=navlinks-children><a href=https://openQA-Bites.github.io/openqa/openqa-cli-cheat-sheet>openqa-cli cheat sheet</a></div></li><li><a title=Categories href=https://openQA-Bites.github.io/categories/>Categories</a></li><li><a title=Tags href=https://openQA-Bites.github.io/tags/>Tags</a></li><li><a title=About href=https://openQA-Bites.github.io/about/>About</a></li><li><a title=Related href=https://openQA-Bites.github.io/related/>Related</a></li></ul></div><div class=avatar-container><div class=avatar-img-border><a title="openQA bites" href=https://openQA-Bites.github.io/><img class=avatar-img src=https://openQA-Bites.github.io/img/avatar-icon.png alt="openQA bites"></a></div></div></div></nav><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><header class=header-section><div class="intro-header no-img"><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=post-heading><h1>Active monitoring of openQA jobs</h1><span class=post-meta><i class="fas fa-calendar"></i>&nbsp;Posted on February 25, 2021
&nbsp;|&nbsp;<i class="fas fa-clock"></i>&nbsp;5&nbsp;minutes
&nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;970&nbsp;words
&nbsp;|&nbsp;<i class="fas fa-user"></i>&nbsp;phoenix</span></div></div></div></div></div></header><div class=container role=main><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><article role=main class=blog-post><p><a href=https://github.com/grisu48/openqa-mon><code>openqa-mon</code></a> is a little command-line utility to monitor one or multiple openQA jobs for their status. This tool is useful if you want to live monitor a handful of jobs closely e.g. for verification runs.</p><p><img src=openqa-mon-demo.gif alt="Demo screencast showing jobs poping up and changing their state"></p><h2 id=example>Example</h2><p>We have been using this tool for half a year already to monitor our virtualization runs. Virtualization runs are a complex construct that run on bare-metal hosts. Our virtualization setup is constantly improving but still sometimes a bit fragile and requires close monitoring. This is what this tool was originally created for.</p><p><img src=openqa-mon.png alt="Terminal screenshot of openQA showing multiple jobs, one line by line."></p><h1 id=installation>Installation</h1><p><strong>Update 2021-12-06</strong>: <code>openqa-mon</code> is now in the main <code>Tumbleweed</code> repository. You can install it via</p><pre><code># zypper in openqa-mon
</code></pre><hr><p><a href=https://github.com/grisu48/openqa-mon><code>openqa-mon</code></a> is packaged in my <a href=https://build.opensuse.org/project/show/home:ph03nix:tools>tools project on OBS</a>. The easiest way to install this on openSUSE is to install it via <a href=https://software.opensuse.org/package/openqa-mon>software.opensuse.org</a> and follow the instructions there. With this approach you will also get updates via your package manager.
For Tumbleweed e.g. the following should work for you:</p><pre><code>zypper addrepo https://download.opensuse.org/repositories/home:ph03nix:tools/openSUSE_Tumbleweed/home:ph03nix:tools.repo
zypper refresh
zypper install openqa-mon
</code></pre><p>I&rsquo;m currently only building for openSUSE/SLE. For other distributions you either use the released binaries from the <a href=https://github.com/grisu48/openqa-mon/releases>release page on GitHub</a> or you follow the following manual build instructions (easy).</p><h2 id=building-it-yourself>Building it yourself</h2><p>In a nutshell:</p><pre><code>make requirements     # install requirements
make
sudo make install     # install the binaries to /usr/local/bin
make install ~/bin    # install the binaries to bin in your home directory
</code></pre><p><code>make requirements</code> downloads all required libraries via <code>go get</code>. The <code>make</code> command builds the program.</p><h1 id=usage>Usage</h1><p>The usage is the following:</p><pre><code>openqa-mon [OPTIONS] JOBS
</code></pre><p><code>JOBS</code> are the jobs you want to monitor via their URL. <code>OPTIONS</code> are optional but useful program arguments that let you control how <code>openqa-mon</code> behaves. The best way to dive into the usage is by showing how we use it.</p><h2 id=example-usage>Example usage</h2><p>Let&rsquo;s assume I want to monitor the following jobs from today&rsquo;s Tumbleweed runs:</p><ul><li><code>RAID0_gpt</code> - <a href=https://openqa.opensuse.org/tests/1644699>https://openqa.opensuse.org/tests/1644699</a></li><li><code>extra_tests_filesystem</code> - <a href=https://openqa.opensuse.org/tests/1644649>https://openqa.opensuse.org/tests/1644649</a></li><li><code>wireguard_client</code> - <a href=https://openqa.opensuse.org/tests/1644850>https://openqa.opensuse.org/tests/1644850</a></li><li><code>wireguard_server</code> - <a href=https://openqa.opensuse.org/tests/1644786>https://openqa.opensuse.org/tests/1644786</a></li></ul><p>I want to get notifications when a job changes its status (<code>-n</code>) and
<code>openqa-mon</code> should follow the job, i.e. show me the cloned job if present (<code>-f</code>). The later is useful to monitor restarted jobs. In addition, I want <code>openqa-mon</code> to update the job status every 10 seconds (<code>--continuous 10</code>). Then the command looks like the following:</p><pre><code> openqa-mon -nf --continuous 10 https://openqa.opensuse.org/tests/1644699 1644649 1644850 1644786
</code></pre><p>Mind how we only needed to add job numbers and not the full URL after one job has been specifying the instance. Of course, you are free to still use the full URL.</p><p><img src=openqa-mon-example.png alt="Output of openqa-mon when for the example above."></p><p>Now every 10 seconds, <code>openqa-mon</code> fetches the current job status and when the job changes its status then you will get a desktop notification. Awesome!</p><h2 id=monitoring-a-job-and-its-children>Monitoring a job and its children</h2><p>Our virtualization runs look like the following:</p><p><img src=virt-runs.png alt="Dependency graph of a virtualization run"></p><p><code>qam-kvm-install</code> is the step that setups up the Hypervisor, followed by a set of individual test cases. If we want to monitor this runs it&rsquo;s cumbersome to define all job IDs. This is why we came up with the <code>-p</code> parameter (or <code>--hierarchy</code>) for showing the job hierarchy. This means, <code>openqa-mon</code> will automatically also add the children of the defined jobs.</p><pre><code>openqa-mon -mfpc 30 http://duck-norris/tests/18038           # duck-norris is my own openQA
</code></pre><p><img src=openqa-mon-children.png alt="openqa-mon showing a job and it&amp;rsquo;s children"></p><p>This is cool because of two things. First, you see 9 jobs, but you have only selected one single job ID. This is because <code>openqa-mon</code> fetches the job and it&rsquo;s children. Second, you see the <code>[DC]</code> in front of the children jobs. <code>[DC]</code> stands for directly chained children.</p><p>The example code above is what we use most of the times in practice for active monitoring of virtualization runs. Another way of using it is when you want to actively and closely monitor a verification run. That&rsquo;s why this utility has been developed in the first place!</p><h2 id=advanced-usage>Advanced usage</h2><p>For more program parameters run <code>openqa-mon -h</code> or consult the man page (when installing from OBS). <code>openqa-mon -h</code> lists a complete description of the available program arguments.</p><p>In addition, I want to show you two nice gimmicks, that can make your life with <code>openqa-mon</code> easier. <code>openqa-mon</code> also supports defining jobs by range. Look at the following two examples:</p><pre><code>openqa-mon -mfc 10 https://openqa.opensuse.org/tests/1644699+2

openqa-mon -mfc 10 https://openqa.opensuse.org/tests/1644699..1644705

openqa-mon -mfc 10 https://openqa.opensuse.org/tests/1644699 http://duck-norris/tests/18038
</code></pre><p>The first line monitors the jobs 1644699 1644700 and 1644701. When the job ID contains a <code>+</code>, <code>openqa-mon</code> interprets it as &ldquo;the given job plus the following numbers <code>n</code>&rdquo;. So here it means, the job itself plus the next two ID&rsquo;s as well.</p><p>The second line allows you to define a custom job range. This is very similar to the <code>+</code>. Here, <code>openqa-mon</code> will monitor all jobs from 1644699 to (inclusive) 1644705. This means, <code>openqa-mon</code> will monitor 1644699, 1644700, 1644701, 1644702, 1644703, 1644704 and 1644705.</p><p>The third line shows that you can monitor jobs from multiple instances at the same time. This is sometimes necessary and useful to have in one terminal without using <code>tmux</code>, <code>terminator</code> or similar.</p><p><code>-mfbc 10</code> is my most commonly used parameter set. It means I want to monitor <code>-m</code> the jobs, i.e. enable bell and desktop notifications, follow the jobs <code>-f</code> and refresh the job list every ten seconds <code>-c 10</code>.</p><h1 id=tldr>TL;DR</h1><ul><li><a href=https://github.com/grisu48/openqa-mon><code>openqa-mon</code></a> actively monitors your openqa jobs and notifies you about job changes</li><li>Use this tool to babysit jobs, like complex test cases or verification runs</li><li>Install: Use the pre-compiled binaries in <a href=https://github.com/grisu48/openqa-mon/releases>releases</a> or build it yourself (easy)</li><li>Packages via OBS will come soon (<a href=https://build.opensuse.org/package/show/home:ph03nix/openqa-mon>preliminary project</a>)</li></ul><p>Usage example which is probably most commonly used:</p><pre><code>openqa-mon -mfc 10 https://openqa.opensuse.org/tests/1644699 1644705+2 1644720..1644725
           |                                         |       |         |
           # -m  - Desktop &amp; bell notifications      |       |         # job range
             -f  - Follow jobs (show restarted jobs) |       |
             -c 10  - refresh every 10 seconds       |       # jobid plus next two jobs
                                                     # Instance and single job id
</code></pre><p><code>openqa-mon</code> also supports jobs across different instances, e.g.</p><pre><code>openqa-mon -mfc 10 https://openqa.opensuse.org/tests/1644699 http://duck-norris/tests/18038</code></pre><div class=blog-tags><a href=https://openQA-Bites.github.io//tags/tools/>tools</a>&nbsp;
<a href=https://openQA-Bites.github.io//tags/openqa-mon/>openqa-mon</a>&nbsp;
<a href=https://openQA-Bites.github.io//tags/cli/>cli</a>&nbsp;</div><hr><section id=social-share><div class="list-inline footer-links"><div class=share-box aria-hidden=true><ul class=share><li><a href="//twitter.com/share?url=https%3a%2f%2fopenQA-Bites.github.io%2fposts%2f2021-02-25-openqa-mon%2f&text=Active%20monitoring%20of%20openQA%20jobs&via=grisu48" target=_blank title="Share on Twitter"><i class="fab fa-twitter"></i></a></li><li><a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fopenQA-Bites.github.io%2fposts%2f2021-02-25-openqa-mon%2f" target=_blank title="Share on Facebook"><i class="fab fa-facebook"></i></a></li><li><a href="//reddit.com/submit?url=https%3a%2f%2fopenQA-Bites.github.io%2fposts%2f2021-02-25-openqa-mon%2f&title=Active%20monitoring%20of%20openQA%20jobs" target=_blank title="Share on Reddit"><i class="fab fa-reddit"></i></a></li><li><a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fopenQA-Bites.github.io%2fposts%2f2021-02-25-openqa-mon%2f&title=Active%20monitoring%20of%20openQA%20jobs" target=_blank title="Share on LinkedIn"><i class="fab fa-linkedin"></i></a></li><li><a href="//www.stumbleupon.com/submit?url=https%3a%2f%2fopenQA-Bites.github.io%2fposts%2f2021-02-25-openqa-mon%2f&title=Active%20monitoring%20of%20openQA%20jobs" target=_blank title="Share on StumbleUpon"><i class="fab fa-stumbleupon"></i></a></li><li><a href="//www.pinterest.com/pin/create/button/?url=https%3a%2f%2fopenQA-Bites.github.io%2fposts%2f2021-02-25-openqa-mon%2f&description=Active%20monitoring%20of%20openQA%20jobs" target=_blank title="Share on Pinterest"><i class="fab fa-pinterest"></i></a></li></ul></div></div></section></article><ul class="pager blog-pager"><li class=previous><a href=https://openQA-Bites.github.io/posts/2021-02-10-needles/ data-toggle=tooltip data-placement=top title="What are Needles">&larr; Previous Post</a></li><li class=next><a href=https://openQA-Bites.github.io/posts/2021-04-07-ipmi/ data-toggle=tooltip data-placement=top title="IPMI remote access on old machines">Next Post &rarr;</a></li></ul></div></div></div><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center footer-links"><li><a href=mailto:felix.niederwanger@suse.de title="Email me"><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-envelope fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://github.com/grisu48 title=GitHub><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-github fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://twitter.com/grisu48 title=Twitter><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-twitter fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://reddit.com/u/grisu48 title=Reddit><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-reddit-alien fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://linkedin.com/in/felix-niederwanger title=LinkedIn><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-linkedin fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://chaos.social/@phoenix title=Mastodon><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-mastodon fa-stack-1x fa-inverse"></i></span></a></li><li><a href title=RSS><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-rss fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="credits copyright text-muted">phoenix
&nbsp;&bull;&nbsp;&copy;
2022
&nbsp;&bull;&nbsp;
<a href=https://openQA-Bites.github.io/>openQA bites</a></p><p class="credits theme-by text-muted"><a href=https://gohugo.io>Hugo v0.101.0</a> powered &nbsp;&bull;&nbsp; Theme <a href=https://github.com/halogenica/beautifulhugo>Beautiful Hugo</a> adapted from <a href=https://deanattali.com/beautiful-jekyll/>Beautiful Jekyll</a></p></div></div></div></footer><script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.js integrity=sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/contrib/auto-render.min.js integrity=sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe crossorigin=anonymous></script>
<script src=https://code.jquery.com/jquery-1.12.4.min.js integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin=anonymous></script>
<script src=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js integrity=sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa crossorigin=anonymous></script>
<script src=https://openQA-Bites.github.io/js/main.js></script><script>renderMathInElement(document.body)</script><script src=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js integrity=sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js integrity=sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q crossorigin=anonymous></script><script src=https://openQA-Bites.github.io/js/load-photoswipe.js></script></body></html>